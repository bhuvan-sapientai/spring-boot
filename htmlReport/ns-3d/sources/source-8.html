


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > LogbackLoggingSystemProperties</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">org.springframework.boot.logging.logback</a>
</div>

<h1>Coverage Summary for Class: LogbackLoggingSystemProperties (org.springframework.boot.logging.logback)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">LogbackLoggingSystemProperties</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/11)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/38)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp; * Copyright 2012-2023 the original author or authors.
&nbsp; *
&nbsp; * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
&nbsp; * you may not use this file except in compliance with the License.
&nbsp; * You may obtain a copy of the License at
&nbsp; *
&nbsp; *      https://www.apache.org/licenses/LICENSE-2.0
&nbsp; *
&nbsp; * Unless required by applicable law or agreed to in writing, software
&nbsp; * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
&nbsp; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
&nbsp; * See the License for the specific language governing permissions and
&nbsp; * limitations under the License.
&nbsp; */
&nbsp;
&nbsp;package org.springframework.boot.logging.logback;
&nbsp;
&nbsp;import java.nio.charset.Charset;
&nbsp;import java.util.function.BiConsumer;
&nbsp;import java.util.function.Function;
&nbsp;
&nbsp;import ch.qos.logback.core.util.FileSize;
&nbsp;
&nbsp;import org.springframework.boot.logging.LogFile;
&nbsp;import org.springframework.boot.logging.LoggingSystemProperties;
&nbsp;import org.springframework.core.convert.ConversionFailedException;
&nbsp;import org.springframework.core.convert.ConverterNotFoundException;
&nbsp;import org.springframework.core.env.Environment;
&nbsp;import org.springframework.core.env.PropertyResolver;
&nbsp;import org.springframework.util.ClassUtils;
&nbsp;import org.springframework.util.unit.DataSize;
&nbsp;
&nbsp;/**
&nbsp; * {@link LoggingSystemProperties} for Logback.
&nbsp; *
&nbsp; * @author Phillip Webb
&nbsp; * @since 2.4.0
&nbsp; * @see RollingPolicySystemProperty
&nbsp; */
&nbsp;public class LogbackLoggingSystemProperties extends LoggingSystemProperties {
&nbsp;
<b class="nc">&nbsp;	private static final boolean JBOSS_LOGGING_PRESENT = ClassUtils.isPresent(&quot;org.jboss.logging.Logger&quot;,</b>
<b class="nc">&nbsp;			LogbackLoggingSystemProperties.class.getClassLoader());</b>
&nbsp;
&nbsp;	/**
&nbsp;	 * The name of the System property that contains the rolled-over log file name
&nbsp;	 * pattern.
&nbsp;	 * @deprecated since 3.2.0 for removal in 3.4.0 in favor of calling
&nbsp;	 * {@link RollingPolicySystemProperty#getEnvironmentVariableName()} on
&nbsp;	 * {@link RollingPolicySystemProperty#FILE_NAME_PATTERN}
&nbsp;	 */
&nbsp;	@Deprecated(since = &quot;3.2.0&quot;, forRemoval = true)
<b class="nc">&nbsp;	public static final String ROLLINGPOLICY_FILE_NAME_PATTERN = RollingPolicySystemProperty.FILE_NAME_PATTERN</b>
<b class="nc">&nbsp;		.getEnvironmentVariableName();</b>
&nbsp;
&nbsp;	/**
&nbsp;	 * The name of the System property that contains the clean history on start flag.
&nbsp;	 * @deprecated since 3.2.0 for removal in 3.4.0 in favor of calling
&nbsp;	 * {@link RollingPolicySystemProperty#getEnvironmentVariableName()} on
&nbsp;	 * {@link RollingPolicySystemProperty#CLEAN_HISTORY_ON_START}
&nbsp;	 */
&nbsp;	@Deprecated(since = &quot;3.2.0&quot;, forRemoval = true)
<b class="nc">&nbsp;	public static final String ROLLINGPOLICY_CLEAN_HISTORY_ON_START = RollingPolicySystemProperty.CLEAN_HISTORY_ON_START</b>
<b class="nc">&nbsp;		.getEnvironmentVariableName();</b>
&nbsp;
&nbsp;	/**
&nbsp;	 * The name of the System property that contains the file log max size.
&nbsp;	 * @deprecated since 3.2.0 for removal in 3.4.0 in favor of calling
&nbsp;	 * {@link RollingPolicySystemProperty#getEnvironmentVariableName()} on
&nbsp;	 * {@link RollingPolicySystemProperty#MAX_FILE_SIZE}
&nbsp;	 */
&nbsp;	@Deprecated(since = &quot;3.2.0&quot;, forRemoval = true)
<b class="nc">&nbsp;	public static final String ROLLINGPOLICY_MAX_FILE_SIZE = RollingPolicySystemProperty.MAX_FILE_SIZE</b>
<b class="nc">&nbsp;		.getEnvironmentVariableName();</b>
&nbsp;
&nbsp;	/**
&nbsp;	 * The name of the System property that contains the file total size cap.
&nbsp;	 * @deprecated since 3.2.0 for removal in 3.4.0 in favor of calling
&nbsp;	 * {@link RollingPolicySystemProperty#getEnvironmentVariableName()} on
&nbsp;	 * {@link RollingPolicySystemProperty#TOTAL_SIZE_CAP}
&nbsp;	 */
&nbsp;	@Deprecated(since = &quot;3.2.0&quot;, forRemoval = true)
<b class="nc">&nbsp;	public static final String ROLLINGPOLICY_TOTAL_SIZE_CAP = RollingPolicySystemProperty.TOTAL_SIZE_CAP</b>
<b class="nc">&nbsp;		.getEnvironmentVariableName();</b>
&nbsp;
&nbsp;	/**
&nbsp;	 * The name of the System property that contains the file log max history.
&nbsp;	 * @deprecated since 3.2.0 for removal in 3.4.0 in favor of calling
&nbsp;	 * {@link RollingPolicySystemProperty#getEnvironmentVariableName()} on
&nbsp;	 * {@link RollingPolicySystemProperty#MAX_HISTORY}
&nbsp;	 */
&nbsp;	@Deprecated(since = &quot;3.2.0&quot;, forRemoval = true)
<b class="nc">&nbsp;	public static final String ROLLINGPOLICY_MAX_HISTORY = RollingPolicySystemProperty.MAX_HISTORY</b>
<b class="nc">&nbsp;		.getEnvironmentVariableName();</b>
&nbsp;
&nbsp;	public LogbackLoggingSystemProperties(Environment environment) {
<b class="nc">&nbsp;		super(environment);</b>
&nbsp;	}
&nbsp;
&nbsp;	/**
&nbsp;	 * Create a new {@link LogbackLoggingSystemProperties} instance.
&nbsp;	 * @param environment the source environment
&nbsp;	 * @param setter setter used to apply the property
&nbsp;	 * @since 2.4.3
&nbsp;	 */
&nbsp;	public LogbackLoggingSystemProperties(Environment environment, BiConsumer&lt;String, String&gt; setter) {
<b class="nc">&nbsp;		super(environment, setter);</b>
&nbsp;	}
&nbsp;
&nbsp;	/**
&nbsp;	 * Create a new {@link LoggingSystemProperties} instance.
&nbsp;	 * @param environment the source environment
&nbsp;	 * @param defaultValueResolver function used to resolve default values or {@code null}
&nbsp;	 * @param setter setter used to apply the property or {@code null} for system
&nbsp;	 * properties
&nbsp;	 * @since 3.2.0
&nbsp;	 */
&nbsp;	public LogbackLoggingSystemProperties(Environment environment, Function&lt;String, String&gt; defaultValueResolver,
&nbsp;			BiConsumer&lt;String, String&gt; setter) {
<b class="nc">&nbsp;		super(environment, defaultValueResolver, setter);</b>
&nbsp;	}
&nbsp;
&nbsp;	@Override
&nbsp;	protected Charset getDefaultCharset() {
<b class="nc">&nbsp;		return Charset.defaultCharset();</b>
&nbsp;	}
&nbsp;
&nbsp;	@Override
&nbsp;	protected void apply(LogFile logFile, PropertyResolver resolver) {
<b class="nc">&nbsp;		super.apply(logFile, resolver);</b>
<b class="nc">&nbsp;		applyJBossLoggingProperties();</b>
<b class="nc">&nbsp;		applyRollingPolicyProperties(resolver);</b>
&nbsp;	}
&nbsp;
&nbsp;	private void applyJBossLoggingProperties() {
<b class="nc">&nbsp;		if (JBOSS_LOGGING_PRESENT) {</b>
<b class="nc">&nbsp;			setSystemProperty(&quot;org.jboss.logging.provider&quot;, &quot;slf4j&quot;);</b>
&nbsp;		}
&nbsp;	}
&nbsp;
&nbsp;	private void applyRollingPolicyProperties(PropertyResolver resolver) {
<b class="nc">&nbsp;		applyRollingPolicy(RollingPolicySystemProperty.FILE_NAME_PATTERN, resolver);</b>
<b class="nc">&nbsp;		applyRollingPolicy(RollingPolicySystemProperty.CLEAN_HISTORY_ON_START, resolver);</b>
<b class="nc">&nbsp;		applyRollingPolicy(RollingPolicySystemProperty.MAX_FILE_SIZE, resolver, DataSize.class);</b>
<b class="nc">&nbsp;		applyRollingPolicy(RollingPolicySystemProperty.TOTAL_SIZE_CAP, resolver, DataSize.class);</b>
<b class="nc">&nbsp;		applyRollingPolicy(RollingPolicySystemProperty.MAX_HISTORY, resolver);</b>
&nbsp;	}
&nbsp;
&nbsp;	private void applyRollingPolicy(RollingPolicySystemProperty property, PropertyResolver resolver) {
<b class="nc">&nbsp;		applyRollingPolicy(property, resolver, String.class);</b>
&nbsp;	}
&nbsp;
&nbsp;	private &lt;T&gt; void applyRollingPolicy(RollingPolicySystemProperty property, PropertyResolver resolver,
&nbsp;			Class&lt;T&gt; type) {
<b class="nc">&nbsp;		T value = getProperty(resolver, property.getApplicationPropertyName(), type);</b>
<b class="nc">&nbsp;		value = (value != null) ? value : getProperty(resolver, property.getDeprecatedApplicationPropertyName(), type);</b>
<b class="nc">&nbsp;		if (value != null) {</b>
<b class="nc">&nbsp;			String stringValue = String.valueOf((value instanceof DataSize dataSize) ? dataSize.toBytes() : value);</b>
<b class="nc">&nbsp;			setSystemProperty(property.getEnvironmentVariableName(), stringValue);</b>
&nbsp;		}
&nbsp;	}
&nbsp;
&nbsp;	@SuppressWarnings(&quot;unchecked&quot;)
&nbsp;	private &lt;T&gt; T getProperty(PropertyResolver resolver, String key, Class&lt;T&gt; type) {
&nbsp;		try {
<b class="nc">&nbsp;			return resolver.getProperty(key, type);</b>
&nbsp;		}
<b class="nc">&nbsp;		catch (ConversionFailedException | ConverterNotFoundException ex) {</b>
<b class="nc">&nbsp;			if (type != DataSize.class) {</b>
<b class="nc">&nbsp;				throw ex;</b>
&nbsp;			}
<b class="nc">&nbsp;			String value = resolver.getProperty(key);</b>
<b class="nc">&nbsp;			return (T) DataSize.ofBytes(FileSize.valueOf(value).getSize());</b>
&nbsp;		}
&nbsp;	}
&nbsp;
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2024-03-28 21:28</div>
</div>
</body>
</html>
